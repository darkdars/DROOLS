package com.sample
 
import com.sample.DroolsTest.Message;
 
 /*
rule "Hello World"
    when
        m : Message( status == Message.HELLO, myMessage : message )
    then
        System.out.println( myMessage );
        m.setMessage( "Goodbye cruel world" );
        m.setStatus( Message.GOODBYE );
        update( m );
end

rule "GoodBye"
    when
        Message( status == Message.GOODBYE, myMessage : message )
    then
        System.out.println( myMessage );
end
*/
global String childrenStr
global Items itemTest
/***********Children*****************/
rule "Check Item sex"
	//salience 100 
	when
		$a: Cliente()
		$b: Items($var : tipo)
		eval($a.checkMale($var))
	then
end

rule "Check Children" extends "Check Item sex"
	
	salience 100 
	when
		$c: Cliente(children == true)
		$f: Armazem($lista : listItems)
		$i: Items(tipo == ($c.checkMaleString().equals("homem") == true ? "crianca_h" : "crianca_m")) from $lista
		eval($c.checkLastitem())
	then
		$c.deleteLastitem();
		System.out.println($i.getNome() + " " + $i.getTipo());
		update($c);
		retract($c);
end

/***********Married*****************/
rule "Check Married"
	salience 90
	when
		$b: Items()
		$c: Cliente(single == false)
		$f: Armazem($lista : listItems)
		$i: Items(tipo == ($c.checkMaleString().equals("homem") == true ? "mulher" : "homem"), descricao == $b.getDescricao()) from $lista
	
	then
		$c.deleteLastitem();
		System.out.println($i.getNome() + " " + $i.getTipo());
		retract($c);
end


/***********Single*****************/
rule "Check Single" 
	salience 80
	when
		$b: Items()
		$c: Cliente(single == true, str : lastitem)
		$f: Armazem($lista : listItems)
		$i: Items(complementar == $b.getComplementar()) from $lista
		
	then
		$c.deleteLastitem();
		System.out.println( $i.getId() );
		retract($c);
end
